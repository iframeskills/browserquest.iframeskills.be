define(["lib/astar"],function(a){var b=Class.extend({init:function(a,b){this.width=a,this.height=b,this.grid=null,this.blankGrid=[],this.initBlankGrid_(),this.ignored=[]},initBlankGrid_:function(){for(var a=0;a<this.height;a+=1){this.blankGrid[a]=[];for(var b=0;b<this.width;b+=1)this.blankGrid[a][b]=0}},findPath:function(b,c,d,e,f){var g=[c.gridX,c.gridY],h=[d,e],i;this.grid=b,this.applyIgnoreList_(!0),i=a(this.grid,g,h),i.length===0&&f===!0&&(i=this.findIncompletePath_(g,h));return i},findIncompletePath_:function(b,c){var d,e,f,g=[];d=a(this.blankGrid,b,c);for(var h=d.length-1;h>0;h-=1){e=d[h][0],f=d[h][1];if(this.grid[f][e]===0){g=a(this.grid,b,[e,f]);break}}return g},ignoreEntity:function(a){a&&this.ignored.push(a)},applyIgnoreList_:function(a){var b=this,c,d,e;_.each(this.ignored,function(e){c=e.isMoving()?e.nextGridX:e.gridX,d=e.isMoving()?e.nextGridY:e.gridY,c>=0&&d>=0&&(b.grid[d][c]=a?0:1)})},clearIgnoreList:function(){this.applyIgnoreList_(!1),this.ignored=[]}});return b})