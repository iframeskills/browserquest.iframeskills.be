define(["jquery","timer"],function(a,b){var c=Class.extend({init:function(a,c,d){this.id=a,this.element=c,this.timer=new b(5e3,d)},isOver:function(a){return this.timer.isOver(a)?!0:!1},destroy:function(){a(this.element).remove()},reset:function(a){this.timer.lastTime=a}}),d=Class.extend({init:function(a){this.container=a,this.bubbles={}},getBubbleById:function(a){return a in this.bubbles?this.bubbles[a]:null},create:function(b,d,e){if(this.bubbles[b])this.bubbles[b].reset(e),a("#"+b+" p").html(d);else{var f=a('<div id="'+b+'" class="bubble"><p>'+d+'</p><div class="thingy"></div></div>');a(f).appendTo(this.container),this.bubbles[b]=new c(b,f,e)}},update:function(a){var b=this,c=[];_.each(this.bubbles,function(b){b.isOver(a)&&(b.destroy(),c.push(b.id))}),_.each(c,function(a){delete b.bubbles[a]})},clean:function(){var a=this,b=[];_.each(this.bubbles,function(a){a.destroy(),b.push(a.id)}),_.each(b,function(b){delete a.bubbles[b]}),this.bubbles={}},destroyBubble:function(a){var b=this.getBubbleById(a);b&&(b.destroy(),delete this.bubbles[a])},forEachBubble:function(a){_.each(this.bubbles,function(b){a(b)})}});return d})