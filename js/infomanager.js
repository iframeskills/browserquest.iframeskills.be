define(function(){var a=Class.extend({init:function(a){this.game=a,this.infos={},this.destroyQueue=[]},addDamageInfo:function(a,b,d,e){var f=this.game.currentTime,g=f+""+Math.abs(a)+""+b+""+d,h=this,i=new c(g,a,b,d,c.DURATION,e);i.onDestroy(function(a){h.destroyQueue.push(a)}),this.infos[g]=i},forEachInfo:function(a){var b=this;_.each(this.infos,function(b,c){a(b)})},update:function(a){var b=this;this.forEachInfo(function(b){b.update(a)}),_.each(this.destroyQueue,function(a){delete b.infos[a]}),this.destroyQueue=[]}}),b={received:{fill:"rgb(255, 50, 50)",stroke:"rgb(255, 180, 180)"},inflicted:{fill:"white",stroke:"#373737"},healed:{fill:"rgb(80, 255, 80)",stroke:"rgb(50, 120, 50)"}},c=Class.extend({DURATION:1e3,init:function(a,c,d,e,f,g){this.id=a,this.value=c,this.duration=f,this.x=d,this.y=e,this.opacity=1,this.lastTime=0,this.speed=100,this.fillColor=b[g].fill,this.strokeColor=b[g].stroke},isTimeToAnimate:function(a){return a-this.lastTime>this.speed},update:function(a){this.isTimeToAnimate(a)&&(this.lastTime=a,this.tick())},tick:function(){this.y-=1,this.opacity-=.07,this.opacity<0&&this.destroy()},onDestroy:function(a){this.destroy_callback=a},destroy:function(){this.destroy_callback&&this.destroy_callback(this.id)}});return a})